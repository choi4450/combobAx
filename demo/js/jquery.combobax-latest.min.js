/* combobAx v0.1.3 | https://github.com/choi4450/combobAx | (c) 2016 Gyumin Choi Foundation | https://github.com/choi4450/combobAx/blob/master/LICENSE.txt */
(function(c){c.fn.combobAxConut=0;c.fn.combobAxConfig={label:"Select another option",bullet:"\u25bc",animateType:"fade",animateDuration:200};c.fn.combobAx=function(p){function f(f){var m,x,g,v,l,w,d={},a=c.extend({},c.fn.combobAxConfig,p),y=c.fn.combobAxConut;c.fn.combobAxConut++;var b=c(f);a.attr=a.prop=a.style=a.selected={};a.attr.id=b.attr("id")||"";a.attr.classname=b.attr("class")||"";a.attr.name=b.attr("name")||"";a.attr.title=b.attr("title")||"";a.prop.disabled=b.prop("disabled");a.prop.required=
b.prop("required");a.style.width=b.outerWidth();a.selected.opt=b.find("option:selected");a.selected.txt=a.selected.opt.text();d.replaceCbo=function(){var e,q,k,h,d;var f='class="combobax'+(a.prop.disabled?" combobax--disabled":"");f+=""!=a.attr.classname?" "+a.attr.classname+'"':'"';var r=d=h=k=void 0;k=""!=a.attr.id?'id="'+a.attr.id+'"':"";h=""!=a.attr.title?'title="'+a.attr.title+'"':"";d='aria-label="'+a.label+'"';r=a.prop.disabled?'disabled tabindex="-1"':"";var t=q=e=void 0;e=""!=a.attr.name?
'name="'+a.attr.name+'"':"";q=a.prop.required?"required":"";t=a.prop.disabled?"disabled":"";var n=function(a){var b="";a.each(function(){var a=c(this),d="",k=a.val()?'value="'+a.val()+'"':"";a.prop("selected")&&(d+=" combobax__item--selected",k+=" checked");a.prop("disabled")&&(d+=" combobax__item--disabled",k+=" disabled");b+='<label class="combobax__item'+d+'"><input class="combobax__item-option" type="radio" '+e+" "+t+" "+q+" "+k+'><span class="combobax__item-txt">'+a.text()+"</span></label>"});
return b},u="<span "+f+' style="width: '+a.style.width+'px;"><button class="combobax__trigger" '+k+' type="button" aria-controls="COMBOBAX'+y+'" '+h+" "+d+" "+r+' aria-expanded="false" '+t+'><span class="combobax__trigger-txt">'+a.selected.txt+'</span><span class="combobax__trigger-bu" aria-hidden="true">'+a.bullet+'</span></button><span class="combobax__listbox" role="radiogroup" aria-label="Options" id="COMBOBAX'+y+'" aria-required="'+a.prop.required+'" aria-hidden="true"'+("css"!==a.animateType?
' style="display: none;"':"")+">";b.find(">*").each(function(){var a=c(this);u=a.is("optgroup")?u+('<span class="combobax__group" role="group" aria-label="'+a.attr("label")+'"><span class="combobax__group-label" aria-hidden="true">'+a.attr("label")+"</span>"+n(a.find("option"))+"</span>"):u+n(a)});u+="</span></span>";k=c(u);b.replaceWith(k);b=k;m=b.find(".combobax__trigger");x=m.find(".combobax__trigger-txt");g=b.find(".combobax__listbox");v=g.find(".combobax__item");l=v.not(".combobax__item--disabled");
v.find(".combobax__item-option");w=l.find(".combobax__item-option")};d.toggleExpandedCbo=function(e){"undefined"==typeof e&&(e="toggle");var q="true"===m.attr("aria-expanded"),d=function(){setTimeout(function(){m.attr("aria-expanded","true");g.attr("aria-hidden","false");b.addClass("combobax--expanded");setTimeout(function(){switch(a.animateType){case "css":b.addClass("combobax--animate");break;default:g.clearQueue().fadeIn(a.animateDuration)}setTimeout(function(){w.filter(":checked").focus()},0)},
0)},0)},h=function(){setTimeout(function(){m.attr("aria-expanded","false");g.attr("aria-hidden","true");setTimeout(function(){switch(a.animateType){case "css":b.removeClass("combobax--animate");break;default:g.clearQueue().fadeOut(a.animateDuration)}setTimeout(function(){b.removeClass("combobax--expanded")},a.animateDuration)},0)},0)};"toggle"!=e&&"open"!=e||!1!==q?"toggle"!=e&&"close"!=e||!0!==q||(h(),c(document).off(".combobAx-closeExpanded")):(d(),setTimeout(function(){c(document).one("click.combobAx-closeExpanded",
function(a){1>b.has(a.target).length&&h()})},0))};d.activeOpt=function(a,b){var e=a.find(".combobax__item-option");"undefined"==typeof b&&(b=!0);v.removeClass("combobax__item--selected");a.addClass("combobax__item--selected");1==b&&(e.focus().prop("checked",!0),x.text(e.siblings(".combobax__item-txt").text()))};d.replaceCbo();m.on("click",function(e){e.preventDefault();if("keydown"!=e.type||13===e.which||32===e.which)a.prop.disabled||d.toggleExpandedCbo()});l.on({mouseover:function(){var a=c(this);
d.activeOpt(a,!1)},mousedown:function(){var a=c(this);d.activeOpt(a);d.toggleExpandedCbo("close")}});w.on("keydown",function(a){var b=c(this);if(9===a.which||13===a.which)a.preventDefault(),m.focus(),d.toggleExpandedCbo("close");else if(37<=a.which&&40>=a.which){a.preventDefault();var b=b.parent(".combobax__item"),b=l.index(b),e=l.length,h,f=g.height(),p=g.offset().top+parseInt(g.css("border-top-width")),r=g.scrollTop();37<=a.which&&38>=a.which?h=0==b?l.last():l.eq(b-1):39<=a.which&&40>=a.which&&
(h=b==e-1?l.first():l.eq(b+1));var t=h.height(),n=h.offset().top-p+r;setTimeout(function(){d.activeOpt(h);n>=f+r?g.scrollTop(n-(f-t)):n<r&&g.scrollTop(n)},0)}})}if(0<=navigator.userAgent.indexOf("MSIE 6"))return!1;c(this).each(function(){f(this)})};c(function(){c("select[data-combobax]").each(function(){var p=c(this),f=p.attr("data-combobax"),f=eval("({"+f+"})");p.combobAx(f)})})})(jQuery);
