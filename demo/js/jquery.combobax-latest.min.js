/* combobAx v0.1.2 | https://github.com/choi4450/combobAx | (c) 2016 Gyumin Choi Foundation | https://github.com/choi4450/combobAx/blob/master/LICENSE.txt */
(function(c){c.fn.combobAxConut=0;c.fn.combobAxConfig={label:"Select another option",bullet:"\u25bc",animateType:"fade",animateDuration:200};c.fn.combobAx=function(p){function g(g){var b,l,x,h,u,k,w,d={},a=c.extend({},c.fn.combobAxConfig,p),y=c.fn.combobAxConut;c.fn.combobAxConut++;b=c(g);a.attr=a.prop=a.style=a.selected={};a.attr.id=b.attr("id")||"";a.attr.classname=b.attr("class")||"";a.attr.name=b.attr("name")||"";a.attr.title=b.attr("title")||"";a.prop.disabled=b.prop("disabled");a.prop.required=
b.prop("required");a.style.width=b.outerWidth();a.selected.opt=b.find("option:selected");a.selected.txt=a.selected.opt.text();d.replaceCbo=function(){var e,q,v,f,d,g,m,r;r='class="combobax'+(a.prop.disabled?" combobax--disabled":"");r+=""!=a.attr.classname?" "+a.attr.classname+'"':'"';m=g=d=f=void 0;f=""!=a.attr.id?'id="'+a.attr.id+'"':"";d=""!=a.attr.title?'title="'+a.attr.title+'"':"";g='aria-label="'+a.label+'"';m=a.prop.disabled?'disabled tabindex="-1"':"";v=q=e=void 0;e=""!=a.attr.name?'name="'+
a.attr.name+'"':"";q=a.prop.required?"required":"";v=a.prop.disabled?"disabled":"";var n=function(a){var b="";a.each(function(){var a=c(this),f="",d=a.val()?'value="'+a.val()+'"':"";a.prop("selected")&&(f+=" combobax__item--selected",d+=" checked");a.prop("disabled")&&(f+=" combobax__item--disabled",d+=" disabled");b+='<label class="combobax__item'+f+'"><input class="combobax__item-option" type="radio" '+e+" "+v+" "+q+" "+d+'><span class="combobax__item-txt">'+a.text()+"</span></label>"});return b},
t="<span "+r+' style="width: '+a.style.width+'px;"><button class="combobax__trigger" '+f+' type="button" aria-controls="COMBOBAX'+y+'" '+d+" "+g+" "+m+' aria-expanded="false" '+v+'><span class="combobax__trigger-txt">'+a.selected.txt+'</span><span class="combobax__trigger-bu" aria-hidden="true">'+a.bullet+'</span></button><span class="combobax__listbox" role="group" aria-label="Options" id="COMBOBAX'+y+'" aria-hidden="true"'+("css"!==a.animateType?' style="display: none;"':"")+">";b.find(">*").each(function(){var a=
c(this);t=a.is("optgroup")?t+('<span class="combobax__group" role="group" aria-label="'+a.attr("label")+'"><span class="combobax__group-label" aria-hidden="true">'+a.attr("label")+"</span>"+n(a.find("option"))+"</span>"):t+n(a)});t+="</span></span>";f=c(t);b.replaceWith(f);b=f;l=b.find(".combobax__trigger");x=l.find(".combobax__trigger-txt");h=b.find(".combobax__listbox");u=h.find(".combobax__item");k=u.not(".combobax__item--disabled");u.find(".combobax__item-option");w=k.find(".combobax__item-option")};
d.toggleExpandedCbo=function(e){"undefined"==typeof e&&(e="toggle");var q="true"===l.attr("aria-expanded"),d=function(){setTimeout(function(){l.attr("aria-expanded","true");h.attr("aria-hidden","false");b.addClass("combobax--expanded");setTimeout(function(){switch(a.animateType){case "css":b.addClass("combobax--animate");break;default:h.clearQueue().fadeIn(a.animateDuration)}setTimeout(function(){w.filter(":checked").focus()},0)},0)},0)},f=function(){setTimeout(function(){l.attr("aria-expanded","false");
h.attr("aria-hidden","true");setTimeout(function(){switch(a.animateType){case "css":b.removeClass("combobax--animate");break;default:h.clearQueue().fadeOut(a.animateDuration)}setTimeout(function(){b.removeClass("combobax--expanded")},a.animateDuration)},0)},0)};"toggle"!=e&&"open"!=e||!1!==q?"toggle"!=e&&"close"!=e||!0!==q||(f(),c(document).off(".combobAx-closeExpanded")):(d(),setTimeout(function(){c(document).one("click.combobAx-closeExpanded",function(a){1>b.has(a.target).length&&f()})},0))};d.activeOpt=
function(a,b){var e=a.find(".combobax__item-option");"undefined"==typeof b&&(b=!0);u.removeClass("combobax__item--selected");a.addClass("combobax__item--selected");1==b&&(e.focus().prop("checked",!0),x.text(e.siblings(".combobax__item-txt").text()))};d.replaceCbo();l.on("click",function(e){e.preventDefault();if("keydown"!=e.type||13===e.which||32===e.which)a.prop.disabled||d.toggleExpandedCbo()});k.on({mouseover:function(){var a=c(this);d.activeOpt(a,!1)},mousedown:function(){var a=c(this);d.activeOpt(a);
d.toggleExpandedCbo("close")}});w.on("keydown",function(a){var b=c(this);if(9===a.which||13===a.which)a.preventDefault(),l.focus(),d.toggleExpandedCbo("close");else if(37<=a.which&&40>=a.which){a.preventDefault();var b=b.parent(".combobax__item"),b=k.index(b),e=k.length,f,g=h.height(),p=h.offset().top+parseInt(h.css("border-top-width")),m=h.scrollTop();37<=a.which&&38>=a.which?f=0==b?k.last():k.eq(b-1):39<=a.which&&40>=a.which&&(f=b==e-1?k.first():k.eq(b+1));var r=f.height(),n=f.offset().top-p+m;
setTimeout(function(){d.activeOpt(f);n>=g+m?h.scrollTop(n-(g-r)):n<m&&h.scrollTop(n)},0)}})}if(0<=navigator.userAgent.indexOf("MSIE 6"))return!1;c(this).each(function(){g(this)})};c(function(){c("select[data-combobax]").each(function(){var p=c(this),g=p.attr("data-combobax"),g=eval("({"+g+"})");p.combobAx(g)})})})(jQuery);
