/* combobAx v0.1.2 | https://github.com/choi4450/combobAx | (c) 2016 Gyumin Choi Foundation | https://github.com/choi4450/combobAx/blob/master/LICENSE.txt */
!function($){$.fn.combobAxConut=0,$.fn.combobAxConfig={label:"Select another option",bullet:"â–¼",animateType:"fade",animateDuration:200},$.fn.combobAx=function(a){function b(b){var c={},d={},e=$.extend({},$.fn.combobAxConfig,a),f=$.fn.combobAxConut;$.fn.combobAxConut++,c.cbo=$(b),e.attr=e.prop=e.style=e.selected={},e.attr.id=c.cbo.attr("id")||"",e.attr.classname=c.cbo.attr("class")||"",e.attr.name=c.cbo.attr("name")||"",e.attr.title=c.cbo.attr("title")||"",e.prop.disabled=c.cbo.prop("disabled"),e.prop.required=c.cbo.prop("required"),e.style.width=c.cbo.outerWidth(),e.selected.opt=c.cbo.find("option:selected"),e.selected.txt=e.selected.opt.text(),d.replaceCbo=function(){var a={};a.box={},a.box.classname='class="combobax',a.box.classname+=e.prop.disabled?" combobax--disabled":"",a.box.classname+=""!=e.attr.classname?" "+e.attr.classname+'"':'"',a.trigger={},a.trigger.id=""!=e.attr.id?'id="'+e.attr.id+'"':"",a.trigger.title=""!=e.attr.title?'title="'+e.attr.title+'"':"",a.trigger.label='aria-label="'+e.label+'"',a.trigger.disabled=e.prop.disabled?'disabled tabindex="-1"':"",a.opt={},a.opt.name=""!=e.attr.name?'name="'+e.attr.name+'"':"",a.opt.required=e.prop.required?"required":"",a.opt.disabled=e.prop.disabled?"disabled":"";var b=function(b){var c="";return b.each(function(){var b=$(this),d="",e=b.val()?'value="'+b.val()+'"':"";b.prop("selected")&&(d+=" combobax__item--selected",e+=" checked"),b.prop("disabled")&&(d+=" combobax__item--disabled",e+=" disabled"),c+='<label class="combobax__item'+d+'"><input class="combobax__item-option" type="radio" '+a.opt.name+" "+a.opt.disabled+" "+a.opt.required+" "+e+'><span class="combobax__item-txt">'+b.text()+"</span></label>"}),c},d="<span "+a.box.classname+' style="width: '+e.style.width+'px;"><button class="combobax__trigger" '+a.trigger.id+' type="button" aria-controls="COMBOBAX'+f+'" '+a.trigger.title+" "+a.trigger.label+" "+a.trigger.disabled+' aria-expanded="false" '+a.opt.disabled+' value="A"><span class="combobax__trigger-txt">'+e.selected.txt+'</span><span class="combobax__trigger-bu" aria-hidden="true">'+e.bullet+'</span></button><span class="combobax__listbox" role="group" aria-label="Options" id="COMBOBAX'+f+'" aria-hidden="true"'+("css"!==e.animateType?' style="display: none;"':"")+">";c.cbo.find(">*").each(function(){var a=$(this);d+=a.is("optgroup")?'<span class="combobax__group" role="group" aria-label="'+a.attr("label")+'"><span class="combobax__group-label" aria-hidden="true">'+a.attr("label")+"</span>"+b(a.find("option"))+"</span>":b(a)}),d+="</span></span>";var g=$(d);c.cbo.replaceWith(g),c.cbo=g,c.trigger=c.cbo.find(".combobax__trigger"),c.triggerTxt=c.trigger.find(".combobax__trigger-txt"),c.listbox=c.cbo.find(".combobax__listbox"),c.items=c.listbox.find(".combobax__item"),c.itemsEnabled=c.items.not(".combobax__item--disabled"),c.opts=c.items.find(".combobax__item-option"),c.optsEnabled=c.itemsEnabled.find(".combobax__item-option")},d.toggleExpandedCbo=function(a){"undefined"==typeof a&&(a="toggle");var b="true"===c.trigger.attr("aria-expanded"),d=function(){setTimeout(function(){c.trigger.attr("aria-expanded","true"),c.listbox.attr("aria-hidden","false"),c.cbo.addClass("combobax--expanded"),setTimeout(function(){switch(e.animateType){case"css":c.cbo.addClass("combobax--animate");break;case"fade":default:c.listbox.clearQueue().fadeIn(e.animateDuration)}setTimeout(function(){c.optsEnabled.filter(":checked").focus()},0)},0)},0)},f=function(){setTimeout(function(){c.trigger.attr("aria-expanded","false"),c.listbox.attr("aria-hidden","true"),setTimeout(function(){switch(e.animateType){case"css":c.cbo.removeClass("combobax--animate");break;case"fade":default:c.listbox.clearQueue().fadeOut(e.animateDuration)}setTimeout(function(){c.cbo.removeClass("combobax--expanded")},e.animateDuration)},0)},0)},g=function(b){return"toggle"==a||a==b};g("open")&&b===!1?(d(),setTimeout(function(){$(document).one("click.combobAx-closeExpanded",function(a){c.cbo.has(a.target).length<1&&f()})},0)):g("close")&&b===!0&&(f(),$(document).off(".combobAx-closeExpanded"))},d.activeOpt=function(a,b){var d=a,e=d.find(".combobax__item-option");"undefined"==typeof b&&(b=!0),c.items.removeClass("combobax__item--selected"),d.addClass("combobax__item--selected"),1==b&&(e.focus().prop("checked",!0),c.triggerTxt.text(e.siblings(".combobax__item-txt").text()))},d.replaceCbo(),c.trigger.on("click",function(a){a.preventDefault(),"keydown"==a.type&&13!==a.which&&32!==a.which||e.prop.disabled||d.toggleExpandedCbo()}),c.itemsEnabled.on({mouseover:function(){var a=$(this);d.activeOpt(a,!1)},mousedown:function(){var a=$(this);d.activeOpt(a),d.toggleExpandedCbo("close")}}),c.optsEnabled.on("keydown",function(a){var b=$(this);if(9===a.which||13===a.which)a.preventDefault(),c.trigger.focus(),d.toggleExpandedCbo("close");else if(a.which>=37&&a.which<=40){a.preventDefault();var h,e=b.parent(".combobax__item"),f=c.itemsEnabled.index(e),g=c.itemsEnabled.length,i=c.listbox.height(),j=c.listbox.offset().top+parseInt(c.listbox.css("border-top-width")),k=c.listbox.scrollTop();a.which>=37&&a.which<=38?h=0==f?c.itemsEnabled.last():c.itemsEnabled.eq(f-1):a.which>=39&&a.which<=40&&(h=f==g-1?c.itemsEnabled.first():c.itemsEnabled.eq(f+1));var l=h.height(),m=h.offset().top-j+k;setTimeout(function(){d.activeOpt(h),m>=i+k?c.listbox.scrollTop(m-(i-l)):m<k&&c.listbox.scrollTop(m)},0)}})}return!(navigator.userAgent.indexOf("MSIE 6")>=0)&&void $(this).each(function(){b(this)})},$(function(){$("select[data-combobax]").each(function(){var $this=$(this),argumentStr=$this.attr("data-combobax"),argumentObj=eval("({"+argumentStr+"})");$this.combobAx(argumentObj)})})}(jQuery);
