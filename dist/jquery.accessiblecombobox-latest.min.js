/* jQuery Accessible combobox v0.1.0 | https://github.com/choi4450/jquery.accessiblecombobox/ | (c) 2015 Gyumin Choi Foundation | https://github.com/choi4450/jquery.accessiblecombobox/blob/master/LICENSE.txt */
(function(d){d.fn.accessibleComboboxConfig={label:"Select another option",bullet:"",style:null,animate:!1,duration:0,easingOpen:null,easingClose:null};d.fn.accessibleCombobox=function(g){if(0<=navigator.userAgent.indexOf("MSIE 6"))return!1;var b=d.extend({},d.fn.accessibleComboboxConfig,g),e={},c,t,v,h,f,q;c=d(this);b.elemId=c.attr("id")||"";b.elemClass=c.attr("class")||"";b.elemName=c.attr("name")||"";b.elemTitle=c.attr("title")||"";b.elemWidth=c.width();b.selectedOpt=c.find("option:selected");b.selectedOptTxt=
b.selectedOpt.text();b.propDisabled=c.prop("disabled");b.propRequired=c.prop("required");e.replaceCbo=function(){var a,r,k,e,n,g,l,u;a='class="'+b.elemClass+" accessiblecbo";a+=b.propDisabled?' is-disabled"':'"';a+=""!=b.elemId?' id="'+b.elemId+'"':"";r=""!=b.elemTitle?'title="'+b.elemTitle+'"':"";k='aria-label="'+b.label+'"';e=""!=b.elemName?'name="'+b.elemName+'"':"";n=b.propRequired?'aria-required="true"':"";g=b.propRequired?'required="required"':"";l=b.propDisabled?'aria-disabled="true" tabindex="-1"':
"";u=b.propDisabled?'disabled="disabled"':"";var m=function(a){var b="";a.each(function(a){a=d(this);var c=a.val()?'value="'+a.val()+'"':"",r="",k="";a.prop("selected")&&(r=a.prop("selected")?" is-selected":"",k=a.prop("selected")?'checked="checked"':"");b+='<label class="accessiblecbo-opt'+r+'"><input type="radio" class="accessiblecbo-opt-radio" '+e+" "+c+" "+u+" "+g+" "+k+'><span class="accessiblecbo-opt-txt">'+a.text()+"</span></label>"});return b},p="<span "+a+' role="menu" aria-live="polite" aria-relevant="all" aria-haspopup="true" aria-expanded="false" style="width: '+
b.elemWidth+'px;" '+l+" "+n+'><a href="#" class="accessiblecbo-btn" role="button" aria-live="off" '+r+" "+k+" "+l+'><span class="accessiblecbo-btn-txt">'+b.selectedOptTxt+'</span><span class="accessiblecbo-btn-bu" aria-hidden="true">'+b.bullet+'</span></a><span class="accessiblecbo-listbox" role="radiogroup" aria-hidden="true" '+n+'><span class="accessiblecbo-listbox-wrap">';c.find(">*").each(function(a){a=d(this);p=a.is("optgroup")?p+('<span class="accessiblecbo-optgroup" role="radiogroup"><em class="accessiblecbo-optgroup-tit">Optgroup</em>'+
m(a.find("option"))+"</span>"):p+m(a)});p+="</span></span></span>";a=d(p);c.replaceWith(a);c=a;t=c.find(".accessiblecbo-btn");v=t.find(".accessiblecbo-btn-txt");h=c.find(".accessiblecbo-listbox");f=h.find(".accessiblecbo-opt");q=f.find(".accessiblecbo-opt-radio")};e.toggleExpandCbo=function(a){"undefined"==typeof a&&(a="toggle");var b=c.attr("aria-expanded"),k=function(){c.attr("aria-expanded","false").removeClass("is-expanded");h.attr("aria-hidden","true")};"toggle"!=a&&"open"!=a||"false"!=b?"toggle"!=
a&&"close"!=a||"true"!=b||(k(),d(document).off(".accessibleCbo-closeExpanded")):(c.attr("aria-expanded","true").addClass("is-expanded"),h.attr("aria-hidden","false"),q.filter(":checked").focus(),setTimeout(function(){d(document).one("click.accessibleCbo-closeExpanded",function(a){1>c.has(a.target).length&&k()})},0))};e.activeOpt=function(a,b){var c=a.find(".accessiblecbo-opt-radio");"undefined"==typeof b&&(b=!0);f.removeClass("is-selected");a.addClass("is-selected");1==b&&(c.focus().prop("checked",
!0),v.text(c.siblings(".accessiblecbo-opt-txt").text()))};e.replaceCbo();t.on("click",function(a){a.preventDefault();if("keydown"!=a.type||13===a.keyCode||32===a.keyCode)b.propDisabled||e.toggleExpandCbo()});f.on({mouseover:function(a){a=d(this);e.activeOpt(a,!1)},mousedown:function(a){a=d(this);e.activeOpt(a);e.toggleExpandCbo("close")}});q.on("keydown",function(a){var b=d(this);if(9===a.keyCode||13===a.keyCode)a.preventDefault(),t.focus(),e.toggleExpandCbo("close");else if(37<=a.keyCode&&40>=a.keyCode){a.preventDefault();
var b=b.parent(".accessiblecbo-opt"),b=f.index(b),c,g=f.length,n=h.height(),q=h.offset().top,l=h.scrollTop();37<=a.keyCode&&38>=a.keyCode?c=0==b?f.last():f.eq(b-1):39<=a.keyCode&&40>=a.keyCode&&(c=b==g-1?f.first():f.eq(b+1));var u=c.height(),m=c.offset().top-q+l;setTimeout(function(){e.activeOpt(c);m>=n+l?h.scrollTop(m-(n-u)):m<l&&h.scrollTop(m)},0)}})};d(function(){d("select[data-accessiblecbo]").each(function(){var g=d(this),b=g.attr("data-accessiblecbo"),b=eval("({"+b+"})");g.accessibleCombobox(b)})})})(jQuery);